# Python 3.13 Compatibility for ControlAltAI-Nodes

This version of ControlAltAI-Nodes has been updated for Python 3.13 compatibility.

## Changes Made

### 1. Future Annotations
- Added `from __future__ import annotations` to all files with type hints
- This enables string-based type annotations and improves compatibility

### 2. Exception Handling
- Replaced bare `except:` clauses with `except Exception:`
- Added `ModuleNotFoundError` to import error handling

### 3. Type Compatibility
- Fixed numpy type aliases (np.int -> np.int32, np.float -> np.float32, np.bool -> np.bool_)
- Added explicit dtype specifications for torch operations
- Updated PIL/Pillow deprecated constants

### 4. Import Safety
- Improved error handling for optional dependencies like xformers
- Made imports more robust against version changes

## Installation

1. Ensure you have Python 3.13 installed
2. Install ComfyUI with Python 3.13 support
3. Copy this folder to your ComfyUI custom_nodes directory:
   ```
   ComfyUI/custom_nodes/ControlAltAI-Nodes/
   ```

## Dependencies

The following packages should be available in your ComfyUI environment:
- torch >= 2.0.0
- torchvision >= 0.15.0
- numpy >= 1.21.0
- pillow >= 9.0.0
- einops >= 0.6.0
- xformers >= 0.0.20 (optional, for attention optimization)

## Backup Files

Backup files (.backup) have been created for all modified files. If you need to restore the original versions:

```bash
# Restore a single file
mv filename.py.backup filename.py

# Restore all files (be careful!)
for f in *.backup; do mv "$f" "${f%.backup}"; done
```

## Testing

After installation, restart ComfyUI and check that all nodes load without errors. If you encounter issues:

1. Check the ComfyUI console for error messages
2. Ensure all dependencies are installed
3. Verify that your ComfyUI installation supports Python 3.13

## Known Issues

- Some third-party dependencies might not yet fully support Python 3.13
- If you encounter xformers-related issues, you may need to install a compatible version or disable xformers optimization

## Support

If you encounter Python 3.13 specific issues, please:
1. Check that the issue is Python 3.13 related
2. Verify all dependencies are properly installed
3. Report the issue with full error logs

---

Generated by Python 3.13 compatibility script
